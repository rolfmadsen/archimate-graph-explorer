var G={},ie=Object.getOwnPropertyNames,T=(e,u)=>function(){return u||(0,e[ie(e)[0]])((u={exports:{}}).exports,u),u.exports},x=T({"node_modules/threads/dist/serializers.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DefaultSerializer=e.extendSerializer=void 0;function u(o,t){const r=o.deserialize.bind(o),c=o.serialize.bind(o);return{deserialize(s){return t.deserialize(s,r)},serialize(s){return t.serialize(s,c)}}}e.extendSerializer=u;var a={deserialize(o){return Object.assign(Error(o.message),{name:o.name,stack:o.stack})},serialize(o){return{__error_marker:"$$error",message:o.message,name:o.name,stack:o.stack}}},b=o=>o&&typeof o=="object"&&"__error_marker"in o&&o.__error_marker==="$$error";e.DefaultSerializer={deserialize(o){return b(o)?a.deserialize(o):o},serialize(o){return o instanceof Error?a.serialize(o):o}}}}),$=T({"node_modules/threads/dist/common.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.serialize=e.deserialize=e.registerSerializer=void 0;var u=x(),a=u.DefaultSerializer;function b(r){a=u.extendSerializer(a,r)}e.registerSerializer=b;function o(r){return a.deserialize(r)}e.deserialize=o;function t(r){return a.serialize(r)}e.serialize=t}}),oe=T({"node_modules/threads/dist/master/get-bundle-url.browser.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getBundleURL=e.getBaseURL=void 0;var u;function a(){return u||(u=b()),u}e.getBundleURL=a;function b(){try{throw new Error}catch(t){const r=(""+t.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(r)return o(r[0])}return"/"}function o(t){return(""+t).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}e.getBaseURL=o}}),Z=T({"node_modules/threads/dist/master/implementation.browser.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isWorkerRuntime=e.getWorkerImplementation=e.defaultPoolSize=void 0;var u=oe();e.defaultPoolSize=typeof navigator<"u"&&navigator.hardwareConcurrency?navigator.hardwareConcurrency:4;var a=s=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(s);function b(s){const d=new Blob([s],{type:"application/javascript"});return URL.createObjectURL(d)}function o(){if(typeof Worker>"u")return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class s extends Worker{constructor(w,v){var f,_;typeof w=="string"&&v&&v._baseURL?w=new URL(w,v._baseURL):typeof w=="string"&&!a(w)&&u.getBundleURL().match(/^file:\/\//i)&&(w=new URL(w,u.getBundleURL().replace(/\/[^\/]+$/,"/")),(!((f=v==null?void 0:v.CORSWorkaround)!==null&&f!==void 0)||f)&&(w=b(`importScripts(${JSON.stringify(w)});`))),typeof w=="string"&&a(w)&&(!((_=v==null?void 0:v.CORSWorkaround)!==null&&_!==void 0)||_)&&(w=b(`importScripts(${JSON.stringify(w)});`)),super(w,v)}}class d extends s{constructor(w,v){const f=window.URL.createObjectURL(w);super(f,v)}static fromText(w,v){const f=new window.Blob([w],{type:"text/javascript"});return new d(f,v)}}return{blob:d,default:s}}var t;function r(){return t||(t=o()),t}e.getWorkerImplementation=r;function c(){const s=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!s)}e.isWorkerRuntime=c}}),ae=T({"node_modules/ms/index.js"(e,u){var a=1e3,b=a*60,o=b*60,t=o*24,r=t*7,c=t*365.25;u.exports=function(v,f){f=f||{};var _=typeof v;if(_==="string"&&v.length>0)return s(v);if(_==="number"&&isFinite(v))return f.long?p(v):d(v);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(v))};function s(v){if(v=String(v),!(v.length>100)){var f=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(v);if(f){var _=parseFloat(f[1]),P=(f[2]||"ms").toLowerCase();switch(P){case"years":case"year":case"yrs":case"yr":case"y":return _*c;case"weeks":case"week":case"w":return _*r;case"days":case"day":case"d":return _*t;case"hours":case"hour":case"hrs":case"hr":case"h":return _*o;case"minutes":case"minute":case"mins":case"min":case"m":return _*b;case"seconds":case"second":case"secs":case"sec":case"s":return _*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return _;default:return}}}}function d(v){var f=Math.abs(v);return f>=t?Math.round(v/t)+"d":f>=o?Math.round(v/o)+"h":f>=b?Math.round(v/b)+"m":f>=a?Math.round(v/a)+"s":v+"ms"}function p(v){var f=Math.abs(v);return f>=t?w(v,f,t,"day"):f>=o?w(v,f,o,"hour"):f>=b?w(v,f,b,"minute"):f>=a?w(v,f,a,"second"):v+" ms"}function w(v,f,_,P){var S=f>=_*1.5;return Math.round(v/_)+" "+P+(S?"s":"")}}}),ue=T({"node_modules/debug/src/common.js"(e,u){function a(b){t.debug=t,t.default=t,t.coerce=w,t.disable=d,t.enable=c,t.enabled=p,t.humanize=ae(),t.destroy=v,Object.keys(b).forEach(f=>{t[f]=b[f]}),t.names=[],t.skips=[],t.formatters={};function o(f){let _=0;for(let P=0;P<f.length;P++)_=(_<<5)-_+f.charCodeAt(P),_|=0;return t.colors[Math.abs(_)%t.colors.length]}t.selectColor=o;function t(f){let _,P=null,S,g;function i(...n){if(!i.enabled)return;const h=i,y=Number(new Date),l=y-(_||y);h.diff=l,h.prev=_,h.curr=y,_=y,n[0]=t.coerce(n[0]),typeof n[0]!="string"&&n.unshift("%O");let k=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,(m,C)=>{if(m==="%%")return"%";k++;const E=t.formatters[C];if(typeof E=="function"){const M=n[k];m=E.call(h,M),n.splice(k,1),k--}return m}),t.formatArgs.call(h,n),(h.log||t.log).apply(h,n)}return i.namespace=f,i.useColors=t.useColors(),i.color=t.selectColor(f),i.extend=r,i.destroy=t.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:()=>P!==null?P:(S!==t.namespaces&&(S=t.namespaces,g=t.enabled(f)),g),set:n=>{P=n}}),typeof t.init=="function"&&t.init(i),i}function r(f,_){const P=t(this.namespace+(typeof _>"u"?":":_)+f);return P.log=this.log,P}function c(f){t.save(f),t.namespaces=f,t.names=[],t.skips=[];const _=(typeof f=="string"?f:"").trim().replace(" ",",").split(",").filter(Boolean);for(const P of _)P[0]==="-"?t.skips.push(P.slice(1)):t.names.push(P)}function s(f,_){let P=0,S=0,g=-1,i=0;for(;P<f.length;)if(S<_.length&&(_[S]===f[P]||_[S]==="*"))_[S]==="*"?(g=S,i=P,S++):(P++,S++);else if(g!==-1)S=g+1,i++,P=i;else return!1;for(;S<_.length&&_[S]==="*";)S++;return S===_.length}function d(){const f=[...t.names,...t.skips.map(_=>"-"+_)].join(",");return t.enable(""),f}function p(f){for(const _ of t.skips)if(s(f,_))return!1;for(const _ of t.names)if(s(f,_))return!0;return!1}function w(f){return f instanceof Error?f.stack||f.message:f}function v(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return t.enable(t.load()),t}u.exports=a}}),H=T({"node_modules/debug/src/browser.js"(e,u){e.formatArgs=b,e.save=o,e.load=t,e.useColors=a,e.storage=r(),e.destroy=(()=>{let s=!1;return()=>{s||(s=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function a(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let s;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(s=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(s[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function b(s){if(s[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+s[0]+(this.useColors?"%c ":" ")+"+"+u.exports.humanize(this.diff),!this.useColors)return;const d="color: "+this.color;s.splice(1,0,d,"color: inherit");let p=0,w=0;s[0].replace(/%[a-zA-Z%]/g,v=>{v!=="%%"&&(p++,v==="%c"&&(w=p))}),s.splice(w,0,d)}e.log=console.debug||console.log||(()=>{});function o(s){try{s?e.storage.setItem("debug",s):e.storage.removeItem("debug")}catch{}}function t(){let s;try{s=e.storage.getItem("debug")}catch{}return!s&&typeof process<"u"&&"env"in process&&(s=G.DEBUG),s}function r(){try{return localStorage}catch{}}u.exports=ue()(e);var{formatters:c}=u.exports;c.j=function(s){try{return JSON.stringify(s)}catch(d){return"[UnexpectedJSONParseError]: "+d.message}}}}),Q=T({"node_modules/observable-fns/dist/_scheduler.js"(e){var u=e&&e.__awaiter||function(b,o,t,r){function c(s){return s instanceof t?s:new t(function(d){d(s)})}return new(t||(t=Promise))(function(s,d){function p(f){try{v(r.next(f))}catch(_){d(_)}}function w(f){try{v(r.throw(f))}catch(_){d(_)}}function v(f){f.done?s(f.value):c(f.value).then(p,w)}v((r=r.apply(b,o||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0}),e.AsyncSerialScheduler=void 0;var a=class{constructor(b){this._baseObserver=b,this._pendingPromises=new Set}complete(){Promise.all(this._pendingPromises).then(()=>this._baseObserver.complete()).catch(b=>this._baseObserver.error(b))}error(b){this._baseObserver.error(b)}schedule(b){const o=Promise.all(this._pendingPromises),t=[],r=s=>t.push(s),c=Promise.resolve().then(()=>u(this,void 0,void 0,function*(){yield o,yield b(r),this._pendingPromises.delete(c);for(const s of t)this._baseObserver.next(s)})).catch(s=>{this._pendingPromises.delete(c),this._baseObserver.error(s)});this._pendingPromises.add(c)}};e.AsyncSerialScheduler=a}}),ce=T({"node_modules/observable-fns/dist/symbols.js"(e){Object.defineProperty(e,"__esModule",{value:!0})}}),K=T({"node_modules/observable-fns/dist/_symbols.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.registerObservableSymbol=e.getSymbol=e.hasSymbol=e.hasSymbols=void 0;var u=()=>typeof Symbol=="function";e.hasSymbols=u;var a=t=>e.hasSymbols()&&!!Symbol[t];e.hasSymbol=a;var b=t=>e.hasSymbol(t)?Symbol[t]:"@@"+t;e.getSymbol=b;function o(){e.hasSymbols()&&!e.hasSymbol("observable")&&(Symbol.observable=Symbol("observable"))}e.registerObservableSymbol=o,e.hasSymbol("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"))}}),I=T({"node_modules/observable-fns/dist/observable.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Observable=e.SubscriptionObserver=e.Subscription=void 0,ce();var u=K(),a=u.getSymbol("iterator"),b=u.getSymbol("observable"),o=u.getSymbol("species");function t(i,n){const h=i[n];if(h!=null){if(typeof h!="function")throw new TypeError(h+" is not a function");return h}}function r(i){let n=i.constructor;return n!==void 0&&(n=n[o],n===null&&(n=void 0)),n!==void 0?n:g}function c(i){return i instanceof g}function s(i){s.log?s.log(i):setTimeout(()=>{throw i},0)}function d(i){Promise.resolve().then(()=>{try{i()}catch(n){s(n)}})}function p(i){const n=i._cleanup;if(n!==void 0&&(i._cleanup=void 0,!!n))try{if(typeof n=="function")n();else{const h=t(n,"unsubscribe");h&&h.call(n)}}catch(h){s(h)}}function w(i){i._observer=void 0,i._queue=void 0,i._state="closed"}function v(i){const n=i._queue;if(n){i._queue=void 0,i._state="ready";for(const h of n)if(f(i,h.type,h.value),i._state==="closed")break}}function f(i,n,h){i._state="running";const y=i._observer;try{const l=y?t(y,n):void 0;switch(n){case"next":l&&l.call(y,h);break;case"error":if(w(i),l)l.call(y,h);else throw h;break;case"complete":w(i),l&&l.call(y);break}}catch(l){s(l)}i._state==="closed"?p(i):i._state==="running"&&(i._state="ready")}function _(i,n,h){if(i._state!=="closed"){if(i._state==="buffering"){i._queue=i._queue||[],i._queue.push({type:n,value:h});return}if(i._state!=="ready"){i._state="buffering",i._queue=[{type:n,value:h}],d(()=>v(i));return}f(i,n,h)}}var P=class{constructor(i,n){this._cleanup=void 0,this._observer=i,this._queue=void 0,this._state="initializing";const h=new S(this);try{this._cleanup=n.call(void 0,h)}catch(y){h.error(y)}this._state==="initializing"&&(this._state="ready")}get closed(){return this._state==="closed"}unsubscribe(){this._state!=="closed"&&(w(this),p(this))}};e.Subscription=P;var S=class{constructor(i){this._subscription=i}get closed(){return this._subscription._state==="closed"}next(i){_(this._subscription,"next",i)}error(i){_(this._subscription,"error",i)}complete(){_(this._subscription,"complete")}};e.SubscriptionObserver=S;var g=class L{constructor(n){if(!(this instanceof L))throw new TypeError("Observable cannot be called as a function");if(typeof n!="function")throw new TypeError("Observable initializer must be a function");this._subscriber=n}subscribe(n,h,y){return(typeof n!="object"||n===null)&&(n={next:n,error:h,complete:y}),new P(n,this._subscriber)}pipe(n,...h){let y=this;for(const l of[n,...h])y=l(y);return y}tap(n,h,y){const l=typeof n!="object"||n===null?{next:n,error:h,complete:y}:n;return new L(k=>this.subscribe({next(j){l.next&&l.next(j),k.next(j)},error(j){l.error&&l.error(j),k.error(j)},complete(){l.complete&&l.complete(),k.complete()},start(j){l.start&&l.start(j)}}))}forEach(n){return new Promise((h,y)=>{if(typeof n!="function"){y(new TypeError(n+" is not a function"));return}function l(){k.unsubscribe(),h(void 0)}const k=this.subscribe({next(j){try{n(j,l)}catch(m){y(m),k.unsubscribe()}},error(j){y(j)},complete(){h(void 0)}})})}map(n){if(typeof n!="function")throw new TypeError(n+" is not a function");const h=r(this);return new h(y=>this.subscribe({next(l){let k=l;try{k=n(l)}catch(j){return y.error(j)}y.next(k)},error(l){y.error(l)},complete(){y.complete()}}))}filter(n){if(typeof n!="function")throw new TypeError(n+" is not a function");const h=r(this);return new h(y=>this.subscribe({next(l){try{if(!n(l))return}catch(k){return y.error(k)}y.next(l)},error(l){y.error(l)},complete(){y.complete()}}))}reduce(n,h){if(typeof n!="function")throw new TypeError(n+" is not a function");const y=r(this),l=arguments.length>1;let k=!1,j=h;return new y(m=>this.subscribe({next(C){const E=!k;if(k=!0,!E||l)try{j=n(j,C)}catch(M){return m.error(M)}else j=C},error(C){m.error(C)},complete(){if(!k&&!l)return m.error(new TypeError("Cannot reduce an empty sequence"));m.next(j),m.complete()}}))}concat(...n){const h=r(this);return new h(y=>{let l,k=0;function j(m){l=m.subscribe({next(C){y.next(C)},error(C){y.error(C)},complete(){k===n.length?(l=void 0,y.complete()):j(h.from(n[k++]))}})}return j(this),()=>{l&&(l.unsubscribe(),l=void 0)}})}flatMap(n){if(typeof n!="function")throw new TypeError(n+" is not a function");const h=r(this);return new h(y=>{const l=[],k=this.subscribe({next(m){let C;if(n)try{C=n(m)}catch(M){return y.error(M)}else C=m;const E=h.from(C).subscribe({next(M){y.next(M)},error(M){y.error(M)},complete(){const M=l.indexOf(E);M>=0&&l.splice(M,1),j()}});l.push(E)},error(m){y.error(m)},complete(){j()}});function j(){k.closed&&l.length===0&&y.complete()}return()=>{l.forEach(m=>m.unsubscribe()),k.unsubscribe()}})}[b](){return this}static from(n){const h=typeof this=="function"?this:L;if(n==null)throw new TypeError(n+" is not an object");const y=t(n,b);if(y){const l=y.call(n);if(Object(l)!==l)throw new TypeError(l+" is not an object");return c(l)&&l.constructor===h?l:new h(k=>l.subscribe(k))}if(u.hasSymbol("iterator")){const l=t(n,a);if(l)return new h(k=>{d(()=>{if(!k.closed){for(const j of l.call(n))if(k.next(j),k.closed)return;k.complete()}})})}if(Array.isArray(n))return new h(l=>{d(()=>{if(!l.closed){for(const k of n)if(l.next(k),l.closed)return;l.complete()}})});throw new TypeError(n+" is not observable")}static of(...n){const h=typeof this=="function"?this:L;return new h(y=>{d(()=>{if(!y.closed){for(const l of n)if(y.next(l),y.closed)return;y.complete()}})})}static get[o](){return this}};e.Observable=g,u.hasSymbols()&&Object.defineProperty(g,Symbol("extensions"),{value:{symbol:b,hostReportError:s},configurable:!0}),e.default=g}}),q=T({"node_modules/observable-fns/dist/unsubscribe.js"(e){Object.defineProperty(e,"__esModule",{value:!0});function u(a){typeof a=="function"?a():a&&typeof a.unsubscribe=="function"&&a.unsubscribe()}e.default=u}}),le=T({"node_modules/observable-fns/dist/filter.js"(e){var u=e&&e.__awaiter||function(r,c,s,d){function p(w){return w instanceof s?w:new s(function(v){v(w)})}return new(s||(s=Promise))(function(w,v){function f(S){try{P(d.next(S))}catch(g){v(g)}}function _(S){try{P(d.throw(S))}catch(g){v(g)}}function P(S){S.done?w(S.value):p(S.value).then(f,_)}P((d=d.apply(r,c||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var a=Q(),b=I(),o=q();function t(r){return c=>new b.default(s=>{const d=new a.AsyncSerialScheduler(s),p=c.subscribe({complete(){d.complete()},error(w){d.error(w)},next(w){d.schedule(v=>u(this,void 0,void 0,function*(){(yield r(w))&&v(w)}))}});return()=>o.default(p)})}e.default=t}}),de=T({"node_modules/observable-fns/dist/_util.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isIterator=e.isAsyncIterator=void 0;var u=K();function a(o){return o&&u.hasSymbol("asyncIterator")&&o[Symbol.asyncIterator]}e.isAsyncIterator=a;function b(o){return o&&u.hasSymbol("iterator")&&o[Symbol.iterator]}e.isIterator=b}}),fe=T({"node_modules/observable-fns/dist/flatMap.js"(e){var u=e&&e.__awaiter||function(s,d,p,w){function v(f){return f instanceof p?f:new p(function(_){_(f)})}return new(p||(p=Promise))(function(f,_){function P(i){try{g(w.next(i))}catch(n){_(n)}}function S(i){try{g(w.throw(i))}catch(n){_(n)}}function g(i){i.done?f(i.value):v(i.value).then(P,S)}g((w=w.apply(s,d||[])).next())})},a=e&&e.__asyncValues||function(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var d=s[Symbol.asyncIterator],p;return d?d.call(s):(s=typeof __values=="function"?__values(s):s[Symbol.iterator](),p={},w("next"),w("throw"),w("return"),p[Symbol.asyncIterator]=function(){return this},p);function w(f){p[f]=s[f]&&function(_){return new Promise(function(P,S){_=s[f](_),v(P,S,_.done,_.value)})}}function v(f,_,P,S){Promise.resolve(S).then(function(g){f({value:g,done:P})},_)}};Object.defineProperty(e,"__esModule",{value:!0});var b=Q(),o=de(),t=I(),r=q();function c(s){return d=>new t.default(p=>{const w=new b.AsyncSerialScheduler(p),v=d.subscribe({complete(){w.complete()},error(f){w.error(f)},next(f){w.schedule(_=>u(this,void 0,void 0,function*(){var P,S;const g=yield s(f);if(o.isIterator(g)||o.isAsyncIterator(g))try{for(var i=a(g),n;n=yield i.next(),!n.done;){const h=n.value;_(h)}}catch(h){P={error:h}}finally{try{n&&!n.done&&(S=i.return)&&(yield S.call(i))}finally{if(P)throw P.error}}else g.map(h=>_(h))}))}});return()=>r.default(v)})}e.default=c}}),he=T({"node_modules/observable-fns/dist/interval.js"(e){Object.defineProperty(e,"__esModule",{value:!0});var u=I();function a(b){return new u.Observable(o=>{let t=0;const r=setInterval(()=>{o.next(t++)},b);return()=>clearInterval(r)})}e.default=a}}),be=T({"node_modules/observable-fns/dist/map.js"(e){var u=e&&e.__awaiter||function(r,c,s,d){function p(w){return w instanceof s?w:new s(function(v){v(w)})}return new(s||(s=Promise))(function(w,v){function f(S){try{P(d.next(S))}catch(g){v(g)}}function _(S){try{P(d.throw(S))}catch(g){v(g)}}function P(S){S.done?w(S.value):p(S.value).then(f,_)}P((d=d.apply(r,c||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var a=Q(),b=I(),o=q();function t(r){return c=>new b.default(s=>{const d=new a.AsyncSerialScheduler(s),p=c.subscribe({complete(){d.complete()},error(w){d.error(w)},next(w){d.schedule(v=>u(this,void 0,void 0,function*(){const f=yield r(w);v(f)}))}});return()=>o.default(p)})}e.default=t}}),me=T({"node_modules/observable-fns/dist/merge.js"(e){Object.defineProperty(e,"__esModule",{value:!0});var u=I(),a=q();function b(...o){return o.length===0?u.Observable.from([]):new u.Observable(t=>{let r=0;const c=o.map(d=>d.subscribe({error(p){t.error(p),s()},next(p){t.next(p)},complete(){++r===o.length&&(t.complete(),s())}})),s=()=>{c.forEach(d=>a.default(d))};return s})}e.default=b}}),Y=T({"node_modules/observable-fns/dist/subject.js"(e){Object.defineProperty(e,"__esModule",{value:!0});var u=I(),a=class extends u.default{constructor(){super(b=>(this._observers.add(b),()=>this._observers.delete(b))),this._observers=new Set}next(b){for(const o of this._observers)o.next(b)}error(b){for(const o of this._observers)o.error(b)}complete(){for(const b of this._observers)b.complete()}};e.default=a}}),ye=T({"node_modules/observable-fns/dist/multicast.js"(e){Object.defineProperty(e,"__esModule",{value:!0});var u=I(),a=Y(),b=q();function o(t){const r=new a.default;let c,s=0;return new u.default(d=>{c||(c=t.subscribe(r));const p=r.subscribe(d);return s++,()=>{s--,p.unsubscribe(),s===0&&(b.default(c),c=void 0)}})}e.default=o}}),we=T({"node_modules/observable-fns/dist/scan.js"(e){var u=e&&e.__awaiter||function(r,c,s,d){function p(w){return w instanceof s?w:new s(function(v){v(w)})}return new(s||(s=Promise))(function(w,v){function f(S){try{P(d.next(S))}catch(g){v(g)}}function _(S){try{P(d.throw(S))}catch(g){v(g)}}function P(S){S.done?w(S.value):p(S.value).then(f,_)}P((d=d.apply(r,c||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});var a=Q(),b=I(),o=q();function t(r,c){return s=>new b.default(d=>{let p,w=0;const v=new a.AsyncSerialScheduler(d),f=s.subscribe({complete(){v.complete()},error(_){v.error(_)},next(_){v.schedule(P=>u(this,void 0,void 0,function*(){p=yield r(w===0?typeof c>"u"?_:c:p,_,w++),P(p)}))}});return()=>o.default(f)})}e.default=t}}),ve=T({"node_modules/observable-fns/dist/index.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.unsubscribe=e.Subject=e.scan=e.Observable=e.multicast=e.merge=e.map=e.interval=e.flatMap=e.filter=void 0;var u=le();Object.defineProperty(e,"filter",{enumerable:!0,get:function(){return u.default}});var a=fe();Object.defineProperty(e,"flatMap",{enumerable:!0,get:function(){return a.default}});var b=he();Object.defineProperty(e,"interval",{enumerable:!0,get:function(){return b.default}});var o=be();Object.defineProperty(e,"map",{enumerable:!0,get:function(){return o.default}});var t=me();Object.defineProperty(e,"merge",{enumerable:!0,get:function(){return t.default}});var r=ye();Object.defineProperty(e,"multicast",{enumerable:!0,get:function(){return r.default}});var c=I();Object.defineProperty(e,"Observable",{enumerable:!0,get:function(){return c.default}});var s=we();Object.defineProperty(e,"scan",{enumerable:!0,get:function(){return s.default}});var d=Y();Object.defineProperty(e,"Subject",{enumerable:!0,get:function(){return d.default}});var p=q();Object.defineProperty(e,"unsubscribe",{enumerable:!0,get:function(){return p.default}})}}),V=T({"node_modules/observable-fns/index.js"(e,u){u.exports=ve()}}),_e=T({"node_modules/threads/dist/ponyfills.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.allSettled=void 0;function u(a){return Promise.all(a.map(b=>{const o=c=>({status:"fulfilled",value:c}),t=c=>({status:"rejected",reason:c}),r=Promise.resolve(b);try{return r.then(o,t)}catch(c){return Promise.reject(c)}}))}e.allSettled=u}}),pe=T({"node_modules/threads/dist/master/pool-types.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.PoolEventType=void 0,function(u){u.initialized="initialized",u.taskCanceled="taskCanceled",u.taskCompleted="taskCompleted",u.taskFailed="taskFailed",u.taskQueued="taskQueued",u.taskQueueDrained="taskQueueDrained",u.taskStart="taskStart",u.terminated="terminated"}(e.PoolEventType||(e.PoolEventType={}))}}),U=T({"node_modules/threads/dist/symbols.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.$worker=e.$transferable=e.$terminate=e.$events=e.$errors=void 0,e.$errors=Symbol("thread.errors"),e.$events=Symbol("thread.events"),e.$terminate=Symbol("thread.terminate"),e.$transferable=Symbol("thread.transferable"),e.$worker=Symbol("thread.worker")}}),X=T({"node_modules/threads/dist/master/thread.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Thread=void 0;var u=U();function a(b){throw Error(b)}e.Thread={errors(b){return b[u.$errors]||a("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},events(b){return b[u.$events]||a("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise.")},terminate(b){return b[u.$terminate]()}}}}),ge=T({"node_modules/threads/dist/master/pool.js"(e){var u=e&&e.__awaiter||function(g,i,n,h){function y(l){return l instanceof n?l:new n(function(k){k(l)})}return new(n||(n=Promise))(function(l,k){function j(E){try{C(h.next(E))}catch(M){k(M)}}function m(E){try{C(h.throw(E))}catch(M){k(M)}}function C(E){E.done?l(E.value):y(E.value).then(j,m)}C((h=h.apply(g,i||[])).next())})},a=e&&e.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(e,"__esModule",{value:!0}),e.Pool=e.Thread=e.PoolEventType=void 0;var b=a(H()),o=V(),t=_e(),r=Z(),c=pe();Object.defineProperty(e,"PoolEventType",{enumerable:!0,get:function(){return c.PoolEventType}});var s=X();Object.defineProperty(e,"Thread",{enumerable:!0,get:function(){return s.Thread}});var d=1;function p(g){const i=[];for(let n=0;n<g;n++)i.push(n);return i}function w(g){return new Promise(i=>setTimeout(i,g))}function v(g,i){return g.reduce((n,h)=>[...n,...i(h)],[])}function f(g){return g.replace(/\W/g," ").trim().replace(/\s+/g,"-")}function _(g,i){return p(i).map(()=>({init:g(),runningTasks:[]}))}var P=class{constructor(g,i){this.eventSubject=new o.Subject,this.initErrors=[],this.isClosing=!1,this.nextTaskID=1,this.taskQueue=[];const n=typeof i=="number"?{size:i}:i||{},{size:h=r.defaultPoolSize}=n;this.debug=b.default(`threads:pool:${f(n.name||String(d++))}`),this.options=n,this.workers=_(g,h),this.eventObservable=o.multicast(o.Observable.from(this.eventSubject)),Promise.all(this.workers.map(y=>y.init)).then(()=>this.eventSubject.next({type:c.PoolEventType.initialized,size:this.workers.length}),y=>{this.debug("Error while initializing pool worker:",y),this.eventSubject.error(y),this.initErrors.push(y)})}findIdlingWorker(){const{concurrency:g=1}=this.options;return this.workers.find(i=>i.runningTasks.length<g)}runPoolTask(g,i){return u(this,void 0,void 0,function*(){const n=this.workers.indexOf(g)+1;this.debug(`Running task #${i.id} on worker #${n}...`),this.eventSubject.next({type:c.PoolEventType.taskStart,taskID:i.id,workerID:n});try{const h=yield i.run(yield g.init);this.debug(`Task #${i.id} completed successfully`),this.eventSubject.next({type:c.PoolEventType.taskCompleted,returnValue:h,taskID:i.id,workerID:n})}catch(h){this.debug(`Task #${i.id} failed`),this.eventSubject.next({type:c.PoolEventType.taskFailed,taskID:i.id,error:h,workerID:n})}})}run(g,i){return u(this,void 0,void 0,function*(){const n=u(this,void 0,void 0,function*(){const h=()=>{g.runningTasks=g.runningTasks.filter(y=>y!==n)};yield w(0);try{yield this.runPoolTask(g,i)}finally{h(),this.isClosing||this.scheduleWork()}});g.runningTasks.push(n)})}scheduleWork(){this.debug("Attempt de-queueing a task in order to run it...");const g=this.findIdlingWorker();if(!g)return;const i=this.taskQueue.shift();if(!i){this.debug("Task queue is empty"),this.eventSubject.next({type:c.PoolEventType.taskQueueDrained});return}this.run(g,i)}taskCompletion(g){return new Promise((i,n)=>{const h=this.events().subscribe(y=>{y.type===c.PoolEventType.taskCompleted&&y.taskID===g?(h.unsubscribe(),i(y.returnValue)):y.type===c.PoolEventType.taskFailed&&y.taskID===g?(h.unsubscribe(),n(y.error)):y.type===c.PoolEventType.terminated&&(h.unsubscribe(),n(Error("Pool has been terminated before task was run.")))})})}settled(g=!1){return u(this,void 0,void 0,function*(){const i=()=>v(this.workers,y=>y.runningTasks),n=[],h=this.eventObservable.subscribe(y=>{y.type===c.PoolEventType.taskFailed&&n.push(y.error)});return this.initErrors.length>0?Promise.reject(this.initErrors[0]):g&&this.taskQueue.length===0?(yield t.allSettled(i()),n):(yield new Promise((y,l)=>{const k=this.eventObservable.subscribe({next(j){j.type===c.PoolEventType.taskQueueDrained&&(k.unsubscribe(),y(void 0))},error:l})}),yield t.allSettled(i()),h.unsubscribe(),n)})}completed(g=!1){return u(this,void 0,void 0,function*(){const i=this.settled(g),n=new Promise((y,l)=>{const k=this.eventObservable.subscribe({next(j){j.type===c.PoolEventType.taskQueueDrained?(k.unsubscribe(),y(i)):j.type===c.PoolEventType.taskFailed&&(k.unsubscribe(),l(j.error))},error:l})}),h=yield Promise.race([i,n]);if(h.length>0)throw h[0]})}events(){return this.eventObservable}queue(g){const{maxQueuedJobs:i=1/0}=this.options;if(this.isClosing)throw Error("Cannot schedule pool tasks after terminate() has been called.");if(this.initErrors.length>0)throw this.initErrors[0];const n=this.nextTaskID++,h=this.taskCompletion(n);h.catch(l=>{this.debug(`Task #${n} errored:`,l)});const y={id:n,run:g,cancel:()=>{this.taskQueue.indexOf(y)!==-1&&(this.taskQueue=this.taskQueue.filter(l=>l!==y),this.eventSubject.next({type:c.PoolEventType.taskCanceled,taskID:y.id}))},then:h.then.bind(h)};if(this.taskQueue.length>=i)throw Error(`Maximum number of pool tasks queued. Refusing to queue another one.
This usually happens for one of two reasons: We are either at peak workload right now or some tasks just won't finish, thus blocking the pool.`);return this.debug(`Queueing task #${y.id}...`),this.taskQueue.push(y),this.eventSubject.next({type:c.PoolEventType.taskQueued,taskID:y.id}),this.scheduleWork(),y}terminate(g){return u(this,void 0,void 0,function*(){this.isClosing=!0,g||(yield this.completed(!0)),this.eventSubject.next({type:c.PoolEventType.terminated,remainingQueue:[...this.taskQueue]}),this.eventSubject.complete(),yield Promise.all(this.workers.map(i=>u(this,void 0,void 0,function*(){return s.Thread.terminate(yield i.init)})))})}};P.EventType=c.PoolEventType;function S(g,i){return new P(g,i)}S.EventType=c.PoolEventType,e.Pool=S}}),ke=T({"node_modules/threads/dist/promise.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createPromiseWithResolver=void 0;var u=()=>{};function a(){let b=!1,o,t=u;return[new Promise(s=>{b?s(o):t=s}),s=>{b=!0,o=s,t(o)}]}e.createPromiseWithResolver=a}}),Se=T({"node_modules/threads/dist/types/master.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkerEventType=void 0,U(),function(u){u.internalError="internalError",u.message="message",u.termination="termination"}(e.WorkerEventType||(e.WorkerEventType={}))}}),Ce=T({"node_modules/threads/dist/observable-promise.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ObservablePromise=void 0;var u=V(),a=()=>{},b=s=>s,o=s=>Promise.resolve().then(s);function t(s){throw s}function r(s){return s&&typeof s.then=="function"}var c=class ee extends u.Observable{constructor(d){super(p=>{const w=this,v=Object.assign(Object.assign({},p),{complete(){p.complete(),w.onCompletion()},error(f){p.error(f),w.onError(f)},next(f){p.next(f),w.onNext(f)}});try{return this.initHasRun=!0,d(v)}catch(f){v.error(f)}}),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(d){this.firstValueSet||(this.firstValue=d,this.firstValueSet=!0)}onError(d){this.state="rejected",this.rejection=d;for(const p of this.rejectionCallbacks)o(()=>p(d))}onCompletion(){this.state="fulfilled";for(const d of this.fulfillmentCallbacks)o(()=>d(this.firstValue))}then(d,p){const w=d||b,v=p||t;let f=!1;return new Promise((_,P)=>{const S=i=>{if(!f){f=!0;try{_(v(i))}catch(n){P(n)}}},g=i=>{try{_(w(i))}catch(n){S(n)}};if(this.initHasRun||this.subscribe({error:S}),this.state==="fulfilled")return _(w(this.firstValue));if(this.state==="rejected")return f=!0,_(v(this.rejection));this.fulfillmentCallbacks.push(g),this.rejectionCallbacks.push(S)})}catch(d){return this.then(void 0,d)}finally(d){const p=d||a;return this.then(w=>(p(),w),()=>p())}static from(d){return r(d)?new ee(p=>{const w=f=>{p.next(f),p.complete()},v=f=>{p.error(f)};d.then(w,v)}):super.from(d)}};e.ObservablePromise=c}}),D=T({"node_modules/threads/dist/transferable.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Transfer=e.isTransferDescriptor=void 0;var u=U();function a(t){return!(!t||typeof t!="object")}function b(t){return t&&typeof t=="object"&&t[u.$transferable]}e.isTransferDescriptor=b;function o(t,r){if(!r){if(!a(t))throw Error();r=[t]}return{[u.$transferable]:!0,send:t,transferables:r}}e.Transfer=o}}),re=T({"node_modules/threads/dist/types/messages.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.WorkerMessageType=e.MasterMessageType=void 0,function(u){u.cancel="cancel",u.run="run"}(e.MasterMessageType||(e.MasterMessageType={})),function(u){u.error="error",u.init="init",u.result="result",u.running="running",u.uncaughtError="uncaughtError"}(e.WorkerMessageType||(e.WorkerMessageType={}))}}),je=T({"node_modules/threads/dist/master/invocation-proxy.js"(e){var u=e&&e.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(e,"__esModule",{value:!0}),e.createProxyModule=e.createProxyFunction=void 0;var a=u(H()),b=V(),o=$(),t=Ce(),r=D(),c=re(),s=a.default("threads:master:messages"),d=1,p=i=>Array.from(new Set(i)),w=i=>i&&i.type===c.WorkerMessageType.error,v=i=>i&&i.type===c.WorkerMessageType.result,f=i=>i&&i.type===c.WorkerMessageType.running;function _(i,n){return new b.Observable(h=>{let y;const l=k=>{if(s("Message from worker:",k.data),!(!k.data||k.data.uid!==n)){if(f(k.data))y=k.data.resultType;else if(v(k.data))y==="promise"?(typeof k.data.payload<"u"&&h.next(o.deserialize(k.data.payload)),h.complete(),i.removeEventListener("message",l)):(k.data.payload&&h.next(o.deserialize(k.data.payload)),k.data.complete&&(h.complete(),i.removeEventListener("message",l)));else if(w(k.data)){const j=o.deserialize(k.data.error);h.error(j),i.removeEventListener("message",l)}}};return i.addEventListener("message",l),()=>{if(y==="observable"||!y){const k={type:c.MasterMessageType.cancel,uid:n};i.postMessage(k)}i.removeEventListener("message",l)}})}function P(i){if(i.length===0)return{args:[],transferables:[]};const n=[],h=[];for(const y of i)r.isTransferDescriptor(y)?(n.push(o.serialize(y.send)),h.push(...y.transferables)):n.push(o.serialize(y));return{args:n,transferables:h.length===0?h:p(h)}}function S(i,n){return(...h)=>{const y=d++,{args:l,transferables:k}=P(h),j={type:c.MasterMessageType.run,uid:y,method:n,args:l};s("Sending command to run function to worker:",j);try{i.postMessage(j,k)}catch(m){return t.ObservablePromise.from(Promise.reject(m))}return t.ObservablePromise.from(b.multicast(_(i,y)))}}e.createProxyFunction=S;function g(i,n){const h={};for(const y of n)h[y]=S(i,y);return h}e.createProxyModule=g}}),Pe=T({"node_modules/threads/dist/master/spawn.js"(e){var u=e&&e.__awaiter||function(l,k,j,m){function C(E){return E instanceof j?E:new j(function(M){M(E)})}return new(j||(j=Promise))(function(E,M){function W(R){try{F(m.next(R))}catch(A){M(A)}}function O(R){try{F(m.throw(R))}catch(A){M(A)}}function F(R){R.done?E(R.value):C(R.value).then(W,O)}F((m=m.apply(l,k||[])).next())})},a=e&&e.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(e,"__esModule",{value:!0}),e.spawn=void 0;var b=a(H()),o=V(),t=$(),r=ke(),c=U(),s=Se(),d=je(),p=b.default("threads:master:messages"),w=b.default("threads:master:spawn"),v=b.default("threads:master:thread-utils"),f=l=>l&&l.type==="init",_=l=>l&&l.type==="uncaughtError",P=typeof process<"u"&&G.THREADS_WORKER_INIT_TIMEOUT?Number.parseInt(G.THREADS_WORKER_INIT_TIMEOUT,10):1e4;function S(l,k,j){return u(this,void 0,void 0,function*(){let m;const C=new Promise((M,W)=>{m=setTimeout(()=>W(Error(j)),k)}),E=yield Promise.race([l,C]);return clearTimeout(m),E})}function g(l){return new Promise((k,j)=>{const m=C=>{p("Message from worker before finishing initialization:",C.data),f(C.data)?(l.removeEventListener("message",m),k(C.data)):_(C.data)&&(l.removeEventListener("message",m),j(t.deserialize(C.data.error)))};l.addEventListener("message",m)})}function i(l,k){return new o.Observable(j=>{const m=E=>{const M={type:s.WorkerEventType.message,data:E.data};j.next(M)},C=E=>{v("Unhandled promise rejection event in thread:",E);const M={type:s.WorkerEventType.internalError,error:Error(E.reason)};j.next(M)};l.addEventListener("message",m),l.addEventListener("unhandledrejection",C),k.then(()=>{const E={type:s.WorkerEventType.termination};l.removeEventListener("message",m),l.removeEventListener("unhandledrejection",C),j.next(E),j.complete()})})}function n(l){const[k,j]=r.createPromiseWithResolver();return{terminate:()=>u(this,void 0,void 0,function*(){v("Terminating worker"),yield l.terminate(),j()}),termination:k}}function h(l,k,j,m){const C=j.filter(E=>E.type===s.WorkerEventType.internalError).map(E=>E.error);return Object.assign(l,{[c.$errors]:C,[c.$events]:j,[c.$terminate]:m,[c.$worker]:k})}function y(l,k){return u(this,void 0,void 0,function*(){w("Initializing new thread");const j=k&&k.timeout?k.timeout:P,C=(yield S(g(l),j,`Timeout: Did not receive an init message from worker after ${j}ms. Make sure the worker calls expose().`)).exposed,{termination:E,terminate:M}=n(l),W=i(l,E);if(C.type==="function"){const O=d.createProxyFunction(l);return h(O,l,W,M)}else if(C.type==="module"){const O=d.createProxyModule(l,C.methods);return h(O,l,W,M)}else{const O=C.type;throw Error(`Worker init message states unexpected type of expose(): ${O}`)}})}e.spawn=y}}),Ee=T({"node_modules/threads/dist/master/index.js"(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Worker=e.BlobWorker=e.isWorkerRuntime=e.Thread=e.spawn=e.Pool=void 0;var u=Z();Object.defineProperty(e,"isWorkerRuntime",{enumerable:!0,get:function(){return u.isWorkerRuntime}});var a=ge();Object.defineProperty(e,"Pool",{enumerable:!0,get:function(){return a.Pool}});var b=Pe();Object.defineProperty(e,"spawn",{enumerable:!0,get:function(){return b.spawn}});var o=X();Object.defineProperty(e,"Thread",{enumerable:!0,get:function(){return o.Thread}}),e.BlobWorker=u.getWorkerImplementation().blob,e.Worker=u.getWorkerImplementation().default}}),Me=T({"node_modules/is-observable/index.js"(e,u){u.exports=a=>a?typeof Symbol.observable=="symbol"&&typeof a[Symbol.observable]=="function"?a===a[Symbol.observable]():typeof a["@@observable"]=="function"?a===a["@@observable"]():!1:!1}}),Te=T({"node_modules/threads/dist/worker/implementation.browser.js"(e){Object.defineProperty(e,"__esModule",{value:!0});var u=function(){const t=typeof self<"u"&&typeof Window<"u"&&self instanceof Window;return!!(typeof self<"u"&&self.postMessage&&!t)},a=function(t,r){self.postMessage(t,r)},b=function(t){const r=s=>{t(s.data)},c=()=>{self.removeEventListener("message",r)};return self.addEventListener("message",r),c};e.default={isWorkerRuntime:u,postMessageToMaster:a,subscribeToMasterMessages:b}}}),Oe=T({"node_modules/threads/dist/worker/index.js"(e){var u=e&&e.__awaiter||function(m,C,E,M){function W(O){return O instanceof E?O:new E(function(F){F(O)})}return new(E||(E=Promise))(function(O,F){function R(z){try{B(M.next(z))}catch(J){F(J)}}function A(z){try{B(M.throw(z))}catch(J){F(J)}}function B(z){z.done?O(z.value):W(z.value).then(R,A)}B((M=M.apply(m,C||[])).next())})},a=e&&e.__importDefault||function(m){return m&&m.__esModule?m:{default:m}};Object.defineProperty(e,"__esModule",{value:!0}),e.expose=e.isWorkerRuntime=e.Transfer=e.registerSerializer=void 0;var b=a(Me()),o=$(),t=D(),r=re(),c=a(Te()),s=$();Object.defineProperty(e,"registerSerializer",{enumerable:!0,get:function(){return s.registerSerializer}});var d=D();Object.defineProperty(e,"Transfer",{enumerable:!0,get:function(){return d.Transfer}}),e.isWorkerRuntime=c.default.isWorkerRuntime;var p=!1,w=new Map,v=m=>m&&m.type===r.MasterMessageType.cancel,f=m=>m&&m.type===r.MasterMessageType.run,_=m=>b.default(m)||P(m);function P(m){return m&&typeof m=="object"&&typeof m.subscribe=="function"}function S(m){return t.isTransferDescriptor(m)?{payload:m.send,transferables:m.transferables}:{payload:m,transferables:void 0}}function g(){const m={type:r.WorkerMessageType.init,exposed:{type:"function"}};c.default.postMessageToMaster(m)}function i(m){const C={type:r.WorkerMessageType.init,exposed:{type:"module",methods:m}};c.default.postMessageToMaster(C)}function n(m,C){const{payload:E,transferables:M}=S(C),W={type:r.WorkerMessageType.error,uid:m,error:o.serialize(E)};c.default.postMessageToMaster(W,M)}function h(m,C,E){const{payload:M,transferables:W}=S(E),O={type:r.WorkerMessageType.result,uid:m,complete:C?!0:void 0,payload:M};c.default.postMessageToMaster(O,W)}function y(m,C){const E={type:r.WorkerMessageType.running,uid:m,resultType:C};c.default.postMessageToMaster(E)}function l(m){try{const C={type:r.WorkerMessageType.uncaughtError,error:o.serialize(m)};c.default.postMessageToMaster(C)}catch(C){console.error(`Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.
Latest error:`,C,`
Original error:`,m)}}function k(m,C,E){return u(this,void 0,void 0,function*(){let M;try{M=C(...E)}catch(O){return n(m,O)}const W=_(M)?"observable":"promise";if(y(m,W),_(M)){const O=M.subscribe(F=>h(m,!1,o.serialize(F)),F=>{n(m,o.serialize(F)),w.delete(m)},()=>{h(m,!0),w.delete(m)});w.set(m,O)}else try{const O=yield M;h(m,!0,o.serialize(O))}catch(O){n(m,o.serialize(O))}})}function j(m){if(!c.default.isWorkerRuntime())throw Error("expose() called in the master thread.");if(p)throw Error("expose() called more than once. This is not possible. Pass an object to expose() if you want to expose multiple functions.");if(p=!0,typeof m=="function")c.default.subscribeToMasterMessages(C=>{f(C)&&!C.method&&k(C.uid,m,C.args.map(o.deserialize))}),g();else if(typeof m=="object"&&m){c.default.subscribeToMasterMessages(E=>{f(E)&&E.method&&k(E.uid,m[E.method],E.args.map(o.deserialize))});const C=Object.keys(m).filter(E=>typeof m[E]=="function");i(C)}else throw Error(`Invalid argument passed to expose(). Expected a function or an object, got: ${m}`);c.default.subscribeToMasterMessages(C=>{if(v(C)){const E=C.uid,M=w.get(E);M&&(M.unsubscribe(),w.delete(E))}})}e.expose=j,typeof self<"u"&&typeof self.addEventListener=="function"&&c.default.isWorkerRuntime()&&(self.addEventListener("error",m=>{setTimeout(()=>l(m.error||m),250)}),self.addEventListener("unhandledrejection",m=>{const C=m.reason;C&&typeof C.message=="string"&&setTimeout(()=>l(C),250)})),typeof process<"u"&&typeof process.on=="function"&&c.default.isWorkerRuntime()&&(process.on("uncaughtException",m=>{setTimeout(()=>l(m),250)}),process.on("unhandledRejection",m=>{m&&typeof m.message=="string"&&setTimeout(()=>l(m),250)}))}}),We=T({"node_modules/threads/dist/index.js"(e){var u=e&&e.__createBinding||(Object.create?function(c,s,d,p){p===void 0&&(p=d),Object.defineProperty(c,p,{enumerable:!0,get:function(){return s[d]}})}:function(c,s,d,p){p===void 0&&(p=d),c[p]=s[d]}),a=e&&e.__exportStar||function(c,s){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(s,d)&&u(s,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Transfer=e.DefaultSerializer=e.expose=e.registerSerializer=void 0;var b=$();Object.defineProperty(e,"registerSerializer",{enumerable:!0,get:function(){return b.registerSerializer}}),a(Ee(),e);var o=Oe();Object.defineProperty(e,"expose",{enumerable:!0,get:function(){return o.expose}});var t=x();Object.defineProperty(e,"DefaultSerializer",{enumerable:!0,get:function(){return t.DefaultSerializer}});var r=D();Object.defineProperty(e,"Transfer",{enumerable:!0,get:function(){return r.Transfer}})}}),N=T({"build/dispatcher.js"(e,u){var{spawn:a,Thread:b,Worker:o}=We(),t=typeof process=="object"&&process+""=="[object process]",r=class{constructor(){this.worker=null,this.workerPath=null}setWorkerPath(s){this.workerPath=s}getWorkerPath(){if(this.workerPath)return this.workerPath;if(t)return"./kuzu_wasm_worker.js";const s=import.meta.url;return`${s.substring(0,s.lastIndexOf("/"))}/kuzu_wasm_worker.js`}async init(){const s=this.getWorkerPath();this.worker=await a(new o(s),{timeout:6e4});const d=await this.worker.init();if(d.isSuccess)return d;throw new Error(d.error)}async close(){this.worker&&await b.terminate(this.worker)}async getWorker(){return this.worker||(this.workerInitPromise||(this.workerInitPromise=this.init()),await this.workerInitPromise,delete this.workerInitPromise),this.worker}},c=new r;u.exports=c}}),Fe=T({"build/database.js"(e,u){var a=N(),b=class{constructor(o,t=0,r=0,c=!0,s=!1,d=!0,p=16777216){this._isInitialized=!1,this._initPromise=null,this._id=null,this._isClosed=!1,this.databasePath=o,this.bufferPoolSize=t,this.maxNumThreads=r,this.enableCompression=c,this.readOnly=s,this.autoCheckpoint=d,this.checkpointThreshold=p}async init(){this._isInitialized||this._initPromise||(this._initPromise=(async()=>{const t=await(await a.getWorker()).databaseConstruct(this.databasePath,this.bufferPoolSize,this.maxNumThreads,this.enableCompression,this.readOnly,this.autoCheckpoint,this.checkpointThreshold);if(t.isSuccess)this._id=t.id,this._isInitialized=!0;else throw new Error(t.error)})()),await this._initPromise,this._initPromise=null}async _getDatabaseObjectId(){if(this._isClosed)throw new Error("Database is closed.");return this._isInitialized||await this.init(),this._id}async close(){this._isClosed||(await(await a.getWorker()).databaseClose(this._id),this._isClosed=!0)}};u.exports=b}}),te=T({"build/query_result.js"(e,u){var a=N(),b=class se{constructor(t){this._id=t,this._isClosed=!1,this._hasNext=void 0,this._hasNextQueryResult=void 0,this._isSuccess=void 0}async _syncValues(){if(this._isClosed)return;const t=await a.getWorker();let r=await t.queryResultHasNext(this._id);if(r.isSuccess)this._hasNext=r.result;else throw new Error(r.error);if(r=await t.queryResultHasNextQueryResult(this._id),r.isSuccess)this._hasNextQueryResult=r.result;else throw new Error(r.error);if(r=await t.queryResultIsSuccess(this._id),r.isSuccess)this._isSuccess=r.result;else throw new Error(r.error)}isSuccess(){return this._isSuccess}async getErrorMessage(){const r=await(await a.getWorker()).queryResultGetErrorMessage(this._id);if(r.isSuccess)return r.result;throw new Error(r.error)}async resetIterator(){const r=await(await a.getWorker()).queryResultResetIterator(this._id);if(!r.isSuccess)throw new Error(r.error);await this._syncValues()}hasNext(){return this._hasNext}hasNextQueryResult(){return this._hasNextQueryResult}async getNumColumns(){const r=await(await a.getWorker()).queryResultGetNumColumns(this._id);if(r.isSuccess)return r.result;throw new Error(r.error)}async getNumTuples(){const r=await(await a.getWorker()).queryResultGetNumTuples(this._id);if(r.isSuccess)return r.result;throw new Error(r.error)}async getColumnNames(){const r=await(await a.getWorker()).queryResultGetColumnNames(this._id);if(r.isSuccess)return r.result;throw new Error(r.error)}async getColumnTypes(){const r=await(await a.getWorker()).queryResultGetColumnTypes(this._id);if(r.isSuccess)return r.result;throw new Error(r.error)}async toString(){const r=await(await a.getWorker()).queryResultToString(this._id);if(r.isSuccess)return r.result;throw new Error(r.error)}async getQuerySummary(){const r=await(await a.getWorker()).queryResultGetQuerySummary(this._id);if(r.isSuccess)return r.result;throw new Error(r.error)}async getNextQueryResult(){const r=await(await a.getWorker()).queryResultGetNextQueryResult(this._id);if(r.isSuccess){const c=r.result,s=new se(c);return await s._syncValues(),s}else throw new Error(r.error)}async getNext(){const r=await(await a.getWorker()).queryResultGetNext(this._id);if(r.isSuccess)return await this._syncValues(),r.result;throw new Error(r.error)}async getAllRows(){const r=await(await a.getWorker()).queryResultGetAllRows(this._id);if(r.isSuccess)return await this._syncValues(),r.result;throw new Error(r.error)}async getAllObjects(){const r=await(await a.getWorker()).queryResultGetAllObjects(this._id);if(r.isSuccess)return await this._syncValues(),r.result;throw new Error(r.error)}async close(){this._isClosed||(await(await a.getWorker()).queryResultClose(this._id),this._isClosed=!0)}};u.exports=b}}),ne=T({"build/prepared_statement.js"(e,u){var a=N(),b=class{constructor(o){this._id=o,this._isClosed=!1,this._isSuccess=void 0}async _syncValues(){if(this._isClosed)return;let t=await(await a.getWorker()).preparedStatementIsSuccess(this._id);if(t.isSuccess)this._isSuccess=t.result;else throw new Error(t.error)}isSuccess(){return this._isSuccess}async getErrorMessage(){const t=await(await a.getWorker()).preparedStatementGetErrorMessage(this._id);if(t.isSuccess)return t.result;throw new Error(t.error)}async close(){this._isClosed||(await(await a.getWorker()).preparedStatementClose(this._id),this._isClosed=!0)}};u.exports=b}}),Re=T({"build/connection.js"(e,u){var a=N(),b=te(),o=ne(),t=class{constructor(r,c=null){this._isInitialized=!1,this._initPromise=null,this._id=null,this._isClosed=!1,this._database=r,this.numThreads=c}async init(){this._isInitialized||(this._initPromise||(this._initPromise=(async()=>{const r=await this._database._getDatabaseObjectId(),s=await(await a.getWorker()).connectionConstruct(r,this.numThreads);if(s.isSuccess)this._id=s.id,this._isInitialized=!0;else throw new Error(s.error)})()),await this._initPromise,this._initPromise=null)}async _getConnectionObjectId(){if(this._isClosed)throw new Error("Connection is closed.");return this._isInitialized||await this.init(),this._id}async setMaxNumThreadForExec(r){const c=await this._getConnectionObjectId(),d=await(await a.getWorker()).connectionSetMaxNumThreadForExec(c,r);if(!d.isSuccess)throw new Error(d.error)}async setQueryTimeout(r){const c=await this._getConnectionObjectId(),d=await(await a.getWorker()).connectionSetQueryTimeout(c,r);if(!d.isSuccess)throw new Error(d.error)}async getMaxNumThreadForExec(){const r=await this._getConnectionObjectId(),s=await(await a.getWorker()).connectionGetMaxNumThreadForExec(r);if(!s.isSuccess)throw new Error(s.error);return s.numThreads}async query(r){const c=await this._getConnectionObjectId(),d=await(await a.getWorker()).connectionQuery(c,r);if(!d.isSuccess)throw new Error(d.error);const p=new b(d.id);return await p._syncValues(),p}async prepare(r){const c=await this._getConnectionObjectId(),d=await(await a.getWorker()).connectionPrepare(c,r);if(!d.isSuccess)throw new Error(d.error);const p=new o(d.id);return await p._syncValues(),p}async execute(r,c={}){const s=await this._getConnectionObjectId(),p=await(await a.getWorker()).connectionExecute(s,r._id,c);if(!p.isSuccess)throw new Error(p.error);const w=new b(p.id);return await w._syncValues(),w}async close(){if(!this._isClosed){const r=await this._getConnectionObjectId();await(await a.getWorker()).connectionClose(r),this._isClosed=!0}}};u.exports=t}}),Ie=T({"build/fs.js"(e,u){var a=N(),b=class{constructor(){}async readFile(o){const r=await(await a.getWorker()).FSReadFile(o);if(r.isFail)throw new Error(r.error);return r}async writeFile(o,t){const c=await(await a.getWorker()).FSWriteFile(o,t);if(!c.isSuccess)throw new Error(c.error)}async mkdir(o){const r=await(await a.getWorker()).FSMkdir(o);if(!r.isSuccess)throw new Error(r.error)}async unlink(o){const r=await(await a.getWorker()).FSUnlink(o);if(!r.isSuccess)throw new Error(r.error)}async rename(o,t){const c=await(await a.getWorker()).FSRename(o,t);if(!c.isSuccess)throw new Error(c.error)}async rmdir(o){const r=await(await a.getWorker()).FSRmdir(o);if(!r.isSuccess)throw new Error(r.error)}async stat(o){const r=await(await a.getWorker()).FSStat(o);if(r.isSuccess)return r.result;throw new Error(r.error)}async readDir(o){const r=await(await a.getWorker()).FSReadDir(o);if(r.isSuccess)return r.result;throw new Error(r.error)}async mountIdbfs(o){const r=await(await a.getWorker()).FSMountIdbfs(o);if(!r.isSuccess)throw new Error(r.error)}async unmount(o){const r=await(await a.getWorker()).FSUnmount(o);if(!r.isSuccess)throw new Error(r.error)}async syncfs(o){const r=await(await a.getWorker()).FSSyncfs(o);if(!r.isSuccess)throw new Error(r.error)}};u.exports=new b}}),ze=T({"build/index.js"(e,u){var a=N(),b=Fe(),o=Re(),t=ne(),r=te(),c=Ie();u.exports={init:async()=>{await a.init()},getVersion:async()=>await(await a.getWorker()).getVersion(),getStorageVersion:async()=>await(await a.getWorker()).getStorageVersion(),setWorkerPath:s=>{a.setWorkerPath(s)},close:async()=>{await a.close()},Database:b,Connection:o,PreparedStatement:t,QueryResult:r,FS:c}}});const Ne=ze();export{Ne as k};
